<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/css-adm/pagina_adm.css">
    <title>Painel Administrativo</title>
    
</head>
<body>
    <div class="header">
        <h1>ğŸ« Painel Administrativo</h1>
        <div class="user-info">
            Logado como: <span id="userEmail">Carregando...</span>
        </div>
    </div>

    <!-- EstatÃ­sticas RÃ¡pidas -->
    <div class="dashboard-stats">
        <div class="stat-card">
            <div class="stat-number" id="totalAlunos">0</div>
            <div class="stat-label">Alunos Cadastrados</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="totalUsuarios">0</div>
            <div class="stat-label">ResponsÃ¡veis</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">6</div>
            <div class="stat-label">MatÃ©rias</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">4</div>
            <div class="stat-label">Turmas Ativas</div>
        </div>
    </div>

    <!-- Menu Principal -->
    <div class="menu-admin">
        <a href="cadastro_aluno.html" class="menu-item">
            <span class="menu-icon">ğŸ‘¨â€ğŸ“</span>
            <div class="menu-title">Cadastrar Aluno</div>
            <div class="menu-description">Adicionar novo aluno ao sistema</div>
        </a>

        <a href="cadastro_notas.html" class="menu-item">
            <span class="menu-icon">ğŸ“Š</span>
            <div class="menu-title">LanÃ§ar Notas</div>
            <div class="menu-description">Inserir notas e mÃ©dias</div>
        </a>

        <a href="cadastro_comunicados.html" class="menu-item">
            <span class="menu-icon">ğŸ“¢</span>
            <div class="menu-title">Comunicados</div>
            <div class="menu-description">Enviar avisos aos responsÃ¡veis</div>
        </a>

        <a href="calendario_adm.html" class="menu-item">
            <span class="menu-icon">ğŸ“…</span>
            <div class="menu-title">CalendÃ¡rio</div>
            <div class="menu-description">Adicionar eventos escolares</div>
        </a>

        <a href="chat_adm.html" class="menu-item">
            <span class="menu-icon">ğŸ’¬</span>
            <div class="menu-title">Chat</div>
            <div class="menu-description">Conversar com responsÃ¡veis</div>
        </a>

        <a href="relatorios.html" class="menu-item">
            <span class="menu-icon">ğŸ“ˆ</span>
            <div class="menu-title">RelatÃ³rios</div>
            <div class="menu-description">RelatÃ³rios e estatÃ­sticas</div>
        </a>
    </div>

    <button class="logout-btn" id="logoutBtn">ğŸšª Sair do Sistema</button>


    <script src="../js/admin/header-admin.js" type="module"></script>
    <script src="../js/firebase.js" type="module"></script>
    <script type="module">
        import { auth, db } from '../../js/firebase.js';
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
        import { collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

        // Verifica autenticaÃ§Ã£o e permissÃµes
        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = '../../index.html';
                return;
            }

            // Mostra email do usuÃ¡rio
            document.getElementById('userEmail').textContent = user.email;
            
            // Verifica se Ã© admin (vocÃª pode implementar uma verificaÃ§Ã£o mais robusta depois)
            console.log("UsuÃ¡rio:", user.email);
            
            // Carrega estatÃ­sticas
            await carregarEstatisticas();
        });

        async function carregarEstatisticas() {
            try {
                // Conta alunos
                const alunosSnapshot = await getDocs(collection(db, "alunos"));
                document.getElementById('totalAlunos').textContent = alunosSnapshot.size;
                
                // Conta usuÃ¡rios
                const usuariosSnapshot = await getDocs(collection(db, "usuarios"));
                document.getElementById('totalUsuarios').textContent = usuariosSnapshot.size;
                
            } catch (error) {
                console.error("Erro ao carregar estatÃ­sticas:", error);
            }
        }

        // Logout
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            try {
                await signOut(auth);
                window.location.href = '../../index.html';
            } catch (error) {
                console.error("Erro ao fazer logout:", error);
            }
        });
    </script>
</body>
</html>